import{u as b,a as M,b as y}from"./Bt_R7xfX.js";import{_ as T,E as S,u as k,i as P,H as _,I as L,o as l,c as d,a,M as x,N as f,F as t,L as c,d as m}from"./BdtuEukF.js";const I={middleware:"auth",data(){return{user:b(),settings:M(),serverMessage:y(),api:null,storeDetails:null,showProductsModal:!1,imageItemsReveal:!1,videoNewItems:"/video/MadFenixLogoReveal.mp4",itemsPurchaseToShow:null,route:S(),accountParameterToUrl:""}},mounted(){var e,i,o,n;this.setUserCookies(),this.setBackground(),window.location.hostname=="our.welore.io"||window.location.hostname=="localhost"?this.accountParameterToUrl=this.route.params.account?this.route.params.account+"/":"":this.accountParameterToUrl="",this.setConfigCookies(),k({title:"Tienda - "+((i=(e=this.user.config)==null?void 0:e.config)==null?void 0:i.name_ecosystem),meta:[{hid:"description",name:"description",content:"Tienda en "+((n=(o=this.user.config)==null?void 0:o.config)==null?void 0:n.name_ecosystem)}]});const{$api:s}=P();this.api=s,this.getStoreDetails()},computed:{},methods:{revealImageItems(){this.imageItemsReveal=!0},setBackground(){(window.location.hostname=="madfenix.com"||window.location.hostname=="www.madfenix.com")&&(document.getElementById("container-global").style.background="transparent url('/img/perfil/back_temp.jpg') no-repeat top center")},afterLogout(){_.remove("token"),_.remove("user"),this.user.setToken(""),this.user.setUserToNull(),this.user.removeUser(),setTimeout(()=>this.$router.push({path:"/"+this.accountParameterToUrl+"login"}),2e3)},logout(){this.api("/api/host/logout",{method:"POST"}).then(()=>this.afterLogout()).catch(()=>this.afterLogout())},afterStoreDetails(s){this.storeDetails=s},getStoreDetails(){this.api("/api/host/store/details",{method:"GET"}).then(s=>this.afterStoreDetails(s)).catch(()=>this.logout())},openNewItems(s){s.nfts.length>0?(this.videoNewItems=s.video_purchase,this.itemsPurchaseToShow=s,s.video_purchase?this.imageItemsReveal=!1:this.imageItemsReveal=!0,this.showProductsModal=!0,s.video_purchase&&L(()=>{document.getElementById("video-storemadfenix").play()})):this.$router.push({path:"/"+this.accountParameterToUrl+"perfil"}),this.getStoreDetails()},validateProduct(s){this.api("/api/host/store/validateProductOrder",{method:"POST",body:{product_order_id:s.id}}).then(e=>this.openNewItems(e)).catch(e=>e.message?e.message==="The given data was invalid."?this.serverMessage.setServerMessage("Datos inválidos."):e.response&&e.response._data&&e.response._data.message?this.serverMessage.setServerMessage(e.response._data.message):e.response&&e.response._data?this.serverMessage.setServerMessage(e.response._data):this.serverMessage.setServerMessage(e.message):e.response&&e.response._data&&e.response._data.message?this.serverMessage.setServerMessage(e.response._data.message):e.response&&e.response._data?this.serverMessage.setServerMessage(e.response._data):this.serverMessage.setServerMessage(e))},buyProduct(s,e,i){this.api("/api/host/store/addProductToOrder",{method:"POST",body:{product_id:s}}).then(o=>{(e>0||i>0)&&this.validateProduct(o)}).catch(o=>o.message?o.message==="The given data was invalid."?this.serverMessage.setServerMessage("Datos inválidos."):o.response&&o.response._data&&o.response._data.message?this.serverMessage.setServerMessage(o.response._data.message):o.response&&o.response._data?this.serverMessage.setServerMessage(o.response._data):this.serverMessage.setServerMessage(o.message):o.response&&o.response._data&&o.response._data.message?this.serverMessage.setServerMessage(o.response._data.message):o.response&&o.response._data?this.serverMessage.setServerMessage(o.response._data):this.serverMessage.setServerMessage(o))},getAccountByDomainName(){const s=window.location.origin,i=new URL(s).hostname.split(".").filter(o=>o!=="www");return i.length>=3?i[i.length-3]:i[i.length-2]},buyProductFiat(s){this.api("/api/host/store/generateStripeLink?user_id="+this.user.user.id+"&product_id="+s+"&account="+(this.accountParameterToUrl?this.accountParameterToUrl.replaceAll("/",""):this.getAccountByDomainName())+"&host_to_return="+encodeURIComponent("https://"+window.location.hostname),{method:"GET"}).then(e=>{e&&(window.location.href=e)}).catch(e=>e.message?e.message==="The given data was invalid."?this.serverMessage.setServerMessage("Datos inválidos."):e.response&&e.response._data&&e.response._data.message?this.serverMessage.setServerMessage(e.response._data.message):e.response&&e.response._data?this.serverMessage.setServerMessage(e.response._data):this.serverMessage.setServerMessage(e.message):e.response&&e.response._data&&e.response._data.message?this.serverMessage.setServerMessage(e.response._data.message):e.response&&e.response._data?this.serverMessage.setServerMessage(e.response._data):this.serverMessage.setServerMessage(e))},getPrice(s){return s.price_oro>0?'<span :class="`text-size-token-store`">'+s.price_oro+"</span> oros":'<span :class="`text-size-token-store`">'+s.price_plumas+"</span> plumas"},setConfigCookies(){let s=localStorage.getItem(this.accountParameterToUrl.replace(/^\/+|\/+$/g,"")+"_config");if(s&&(s=JSON.parse(s)),s)this.user.setConfig(this.accountParameterToUrl,s);else try{this.user.fetchConfig(this.accountParameterToUrl)}catch{}},setUserCookies(){let s=localStorage.getItem("token");if(s){this.user.setToken(s);let e=localStorage.getItem("user");if(e)this.user.updateUser(JSON.parse(e));else{console.log("test");try{this.user.fetchUser()}catch{}}}}}},C={key:0},j={class:t("px-4 py-12 md:py-16 sm:px-6 lg:px-8")},U={class:t("max-w-screen-xl mx-auto")},D={class:t("w-full max-w-3xl mx-auto text-center lg:max-w-5xl")},N={class:t("mt-4 text-4xl font-extrabold text-[color:var(--naranja)] md:mt-5 sm:text-5xl md:text-6xl")},H=["innerHTML"],R={class:t("relative z-30 grid grid-cols-1 sm:grid-cols-12 items-center justify-center mx-auto text-center px-4 sm:px-16 lg:flex-row lg:text-left")},B={class:t("sm:col-span-3 flex items-center py-6 sm:py-0 px-12 h-full text-2xl rounded-tl-3xl rounded-tr-3xl sm:rounded-tr-none bg-[color:var(--gris)] border border-[color:var(--naranja)] sm:border-r-0 font-bold sm:text-4xl")},z=["src","title","alt"],E={class:t("sm:col-span-9 px-3 sm:px-0 py-3 sm:py-0 sm:flex sm:items-center space-x-3 justify-center h-full rounded-br-3xl rounded-bl-3xl sm:rounded-bl-none bg-[color:var(--gris)] border border-[color:var(--naranja)] sm:border-l-0 sm:mr-12 lg:justify-end")},O={class:t("grow font-extrabold tracking-tight")},F={class:t("font-extrabold tracking-tight text-[color:var(--naranja)] text-4xl sm:text-5xl")},A=["innerHTML"],V=["innerHTML"],G={class:t("botones-tokens")},J=["onClick"],q=["innerHTML"],K=["onClick"],Q=["innerHTML"],W={key:1,tabindex:"-1","aria-hidden":"true",class:t("overflow-y-auto overflow-x-hidden bg-[color:var(--gris)] bg-opacity-50 fixed top-0 right-0 left-0 z-50 w-full h-modal md:h-full")},X={class:t("flex items-center justify-center p-4 w-full h-screen")},Y={class:t("bg-[color:var(--gris)] text-[color:var(--blanco)] rounded-lg shadow border border-[color:var(--blanco)]")},Z={class:t("flex justify-between items-start p-4 rounded-t border-b border-[color:var(--blanco)]")},$={"aria-hidden":"true",class:t("w-5 h-5"),fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},ee={class:t("w-full p-3 overflow-y-auto"),style:{height:"500px","max-width":"700px"}},se=["src"],te={key:1,class:t("grid grid-cols-2 md:grid-cols-3 gap-2")},ae={class:t("relative rounded-tr-3xl rounded-bl-3xl border-2 border-[color:var(--naranja)] bg-[color:var(--gris)] overflow-hidden")},oe=["src","alt","title"],re=["innerHTML"];function ne(s,e,i,o,n,g){var h,u,p,v;return n.storeDetails&&((u=(h=n.user.config)==null?void 0:h.config)!=null&&u.active_store)?(l(),d("div",C,[a("section",j,[a("div",U,[a("div",D,[a("h1",N,[a("span",{innerHTML:((v=(p=n.user.config)==null?void 0:p.theme)==null?void 0:v.title_store_h1)??"Pasa al siguiente nivel"},null,8,H)])])])]),n.storeDetails.products?(l(!0),d(x,{key:0},f(n.storeDetails.products,r=>(l(),d("section",{class:t("max-w-screen-xl px-4 py-12 mx-auto md:py-16 sm:px-6 lg:px-8"),key:r.id},[a("div",R,[a("div",B,[a("img",{src:r.image,title:r.name,alt:r.name,class:t("inset-y-0 z-40 w-full")},null,8,z)]),a("div",E,[a("div",O,[a("h5",F,[a("span",{innerHTML:r.name},null,8,A)]),r.short_description?(l(),d("p",{key:0,class:t("text-[color:var(--blanco)] text-xl"),innerHTML:r.short_description},null,8,V)):c("",!0)]),a("div",G,[r.price_fiat>0?(l(),d("a",{key:0,onClick:w=>g.buyProductFiat(r.id),class:t("w-full m-auto justify-center px-8 py-4 btn-madfenix text-[color:var(--gris)] font-semibold bg-[color:var(--naranja)] leading-snug transition ease-in-out h-10 lg:h-14 duration-250 hover:text-[color:var(--naranja)] hover:bg-[color:var(--gris)] border-[color:var(--naranja)] border-2 cursor-pointer")},[e[2]||(e[2]=m(" Comprar por ")),a("span",{innerHTML:r.price_fiat},null,8,q),e[3]||(e[3]=m("€ "))],8,J)):(l(),d("a",{key:1,onClick:w=>g.buyProduct(r.id,r.price_oro,r.price_plumas),class:t("w-full m-auto justify-center px-8 py-4 btn-madfenix text-[color:var(--gris)] font-semibold bg-[color:var(--naranja)] leading-snug transition ease-in-out h-10 lg:h-14 duration-250 hover:text-[color:var(--naranja)] hover:bg-[color:var(--gris)] border-[color:var(--naranja)] border-2 cursor-pointer")},[e[4]||(e[4]=m(" Comprar por ")),a("span",{innerHTML:g.getPrice(r)},null,8,Q)],8,K))])])])]))),128)):c("",!0),n.showProductsModal?(l(),d("div",W,[a("div",X,[a("div",Y,[a("div",Z,[e[7]||(e[7]=a("h3",{class:t("text-xl font-semibold")}," ¡Tus nuevos ítems! ",-1)),a("button",{type:"button",onClick:e[0]||(e[0]=r=>{n.showProductsModal=!1,n.imageItemsReveal=!1}),class:t("text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white")},[(l(),d("svg",$,e[5]||(e[5]=[a("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1)]))),e[6]||(e[6]=a("span",{class:t("sr-only")},"Cerrar pantalla",-1))])]),a("div",ee,[n.imageItemsReveal?c("",!0):(l(),d("video",{key:0,id:"video-storemadfenix",class:t("rounded rounded-3xl border border-2 border-[color:var(--gris)]"),playsinline:"",onEnded:e[1]||(e[1]=r=>g.revealImageItems())},[a("source",{src:n.videoNewItems,type:"video/mp4"},null,8,se),e[8]||(e[8]=m(" Tu navegador no soporta el video. "))],32)),n.imageItemsReveal&&n.itemsPurchaseToShow?(l(),d("div",te,[(l(!0),d(x,null,f(n.itemsPurchaseToShow.nfts,r=>(l(),d("div",{key:r.id},[a("div",ae,[a("img",{src:r.image,style:{width:"100%"},alt:r.name,title:r.name},null,8,oe),a("div",{class:t("px-6 mt-3 mb-10 relative z-50 w-full text-center text-[color:var(--blanco)]"),innerHTML:r.name},null,8,re)])]))),128))])):c("",!0)])])])])):c("",!0)])):c("",!0)}const de=T(I,[["render",ne]]);export{de as _};
